
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module BSemanticsSimpl</title>
<meta name="description" content="Documentation of Coq module BSemanticsSimpl" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module BSemanticsSimpl</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">compcert</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html">Memory</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html">Memtype</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html">Integers</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html">Values</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.cfrontend.Ctypes.html">Ctypes</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html">AST</a></span>.<br/>
<span class="kwd">From</span> <span class="id">compcert.arm</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.arm.AsmSyntax.html">AsmSyntax</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.arm.ABinSem.html">ABinSem</a></span>.<br/>
<span class="kwd">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith.html">ZArith</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">bpf.comm</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="bpf.comm.Flag.html">Flag</a></span> <span class="id"><a href="bpf.comm.rBPFValues.html">rBPFValues</a></span> <span class="id"><a href="bpf.comm.BinrBPF.html">BinrBPF</a></span> <span class="id"><a href="bpf.comm.MemRegion.html">MemRegion</a></span>.<br/>
<span class="kwd">From</span> <span class="id">bpf.comm</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="bpf.comm.rBPFAST.html">rBPFAST</a></span> <span class="id"><a href="bpf.comm.rBPFMemType.html">rBPFMemType</a></span> <span class="id"><a href="bpf.comm.ListAsArray.html">ListAsArray</a></span> <span class="id"><a href="bpf.comm.JITCall.html">JITCall</a></span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">bpf.rbpf32</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="bpf.rbpf32.TSSyntax.html">TSSyntax</a></span> <span class="id"><a href="bpf.rbpf32.TSDecode.html">TSDecode</a></span> <span class="id"><a href="bpf.rbpf32.BState.html">BState</a></span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="check_mem_aux2">check_mem_aux2</a></span> (<span class="id">mr</span>: <span class="id"><a href="bpf.comm.MemRegion.html#memory_region">memory_region</a></span>) (<span class="id">perm</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#permission">permission</a></span>) (<span class="id">addr</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span>) (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>): <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">lo_ofs</span> := <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.sub">Val.sub</a></span> <span class="id">addr</span> (<span class="id"><a href="bpf.comm.MemRegion.html#start_addr">start_addr</a></span> <span class="id">mr</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">hi_ofs</span> := <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> <span class="id">lo_ofs</span> (<span class="id"><a href="bpf.comm.rBPFAST.html#memory_chunk_to_valu32">memory_chunk_to_valu32</a></span> <span class="id">chunk</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb">andb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb">andb</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="bpf.comm.rBPFValues.html#compu_le">compu_le</a></span> <span class="id">hi_ofs</span> (<span class="id"><a href="bpf.comm.MemRegion.html#block_size">block_size</a></span> <span class="id">mr</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb">andb</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#compu_le">compu_le</a></span> <span class="id">lo_ofs</span> (<span class="id"><a href="bpf.comm.rBPFAST.html#memory_chunk_to_valu32_upbound">memory_chunk_to_valu32_upbound</a></span> <span class="id">chunk</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="bpf.comm.rBPFValues.html#comp_eq">comp_eq</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vzero">Vzero</a></span> (<span class="id"><a href="bpf.comm.rBPFValues.html#val32_modu">val32_modu</a></span> <span class="id">lo_ofs</span> (<span class="id"><a href="bpf.comm.rBPFAST.html#memory_chunk_to_valu32">memory_chunk_to_valu32</a></span> <span class="id">chunk</span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="bpf.comm.rBPFMemType.html#perm_ge">perm_ge</a></span> (<span class="id"><a href="bpf.comm.MemRegion.html#block_perm">block_perm</a></span> <span class="id">mr</span>) <span class="id">perm</span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> (<span class="id"><a href="bpf.comm.MemRegion.html#block_ptr">block_ptr</a></span> <span class="id">mr</span>) <span class="id">lo_ofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vnullptr">Vnullptr</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="get_mem_region">get_mem_region</a></span> (<span class="id">n</span> <span class="id">mrs_num</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">mrs</span>: <span class="id"><a href="bpf.comm.MemRegion.html#MyMemRegionsType">MyMemRegionsType</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="bpf.comm.MemRegion.html#memory_region">memory_region</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.ltb">Nat.ltb</a></span> <span class="id">n</span> <span class="id">mrs_num</span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">List.nth_error</a></span> <span class="id">mrs</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">mr</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">mr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="check_mem_aux">check_mem_aux</a></span> (<span class="id">num</span> <span class="id">mrs_num</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">perm</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#permission">permission</a></span>) (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">addr</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span>) (<span class="id">mrs</span>: <span class="id"><a href="bpf.comm.MemRegion.html#MyMemRegionsType">MyMemRegionsType</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>) {<span class="kwd">struct</span> <span class="id">num</span>}: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">num</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vnullptr">Vnullptr</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#get_mem_region">get_mem_region</a></span> <span class="id">n</span> <span class="id">mrs_num</span> <span class="id">mrs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cur_mr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">check_ptr</span>  := <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#check_mem_aux2">check_mem_aux2</a></span> <span class="id">cur_mr</span> <span class="id">perm</span> <span class="id">addr</span> <span class="id">chunk</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.comm.rBPFValues.html#cmp_ptr32_null">cmp_ptr32_null</a></span> <span class="id">m</span> <span class="id">check_ptr</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">is_null</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">check_mem_aux</span> <span class="id">n</span> <span class="id">mrs_num</span> <span class="id">perm</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">mrs</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">check_ptr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="check_mem">check_mem</a></span> (<span class="id">perm</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#permission">permission</a></span>) (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">addr</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span>) (<span class="id">mrs_num</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">mrs</span>: <span class="id"><a href="bpf.comm.MemRegion.html#MyMemRegionsType">MyMemRegionsType</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#check_mem_aux">check_mem_aux</a></span> <span class="id">mrs_num</span> <span class="id">mrs_num</span> <span class="id">perm</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">mrs</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">check_ptr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.comm.rBPFValues.html#cmp_ptr32_null">cmp_ptr32_null</a></span> <span class="id">m</span> <span class="id">check_ptr</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">is_null</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vnullptr">Vnullptr</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">check_ptr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="load_mem">load_mem</a></span> (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">ptr</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">chunk</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span> | <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint16unsigned">Mint16unsigned</a></span> | <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">ptr</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vundef">Vundef</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">res</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">res</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step_load_x_operation">step_load_x_operation</a></span> (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">d</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#breg">breg</a></span>) (<span class="id">s</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#breg">breg</a></span>) (<span class="id">ofs</span>:<span class="id"><a href="bpf.rbpf32.TSSyntax.html#off">off</a></span>) (<span class="id">rs</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#regset">regset</a></span>) (<span class="id">mrs_num</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">mrs</span>: <span class="id"><a href="bpf.comm.MemRegion.html#MyMemRegionsType">MyMemRegionsType</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="bpf.rbpf32.TSSyntax.html#regset">regset</a></span> * <span class="id"><a href="bpf.comm.Flag.html#bpf_flag">bpf_flag</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">addr</span>  := <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> (<span class="id">rs</span>#<span class="id">s</span>) (<span class="id"><a href="bpf.comm.rBPFValues.html#sint32_to_vint">sint32_to_vint</a></span> <span class="id">ofs</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Readable">Readable</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">mrs_num</span> <span class="id">mrs</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ptr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.comm.rBPFValues.html#cmp_ptr32_null">cmp_ptr32_null</a></span> <span class="id">m</span> <span class="id">ptr</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">is_null</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>, <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#load_mem">load_mem</a></span> <span class="id">chunk</span> <span class="id">ptr</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>#<span class="id">d</span> &lt;- <span class="id">v</span>, <span class="id"><a href="bpf.comm.Flag.html#BPF_OK">BPF_OK</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="store_mem">store_mem</a></span> (<span class="id">ptr</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span>) (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">v</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">chunk</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span> | <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint16unsigned">Mint16unsigned</a></span> | <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#Mint32">Mint32</a></span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">ptr</span> <span class="id">v</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step_store_operation">step_store_operation</a></span> (<span class="id">chunk</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">d</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#breg">breg</a></span>) (<span class="id">s</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#breg">breg</a></span>+<span class="id"><a href="bpf.rbpf32.TSSyntax.html#imm">imm</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#off">off</a></span>) (<span class="id">rs</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#regset">regset</a></span>) (<span class="id">mrs_num</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">mrs</span>: <span class="id"><a href="bpf.comm.MemRegion.html#MyMemRegionsType">MyMemRegionsType</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span> * <span class="id"><a href="bpf.comm.Flag.html#bpf_flag">bpf_flag</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">addr</span> := <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> (<span class="id">rs</span>#<span class="id">d</span>) (<span class="id"><a href="bpf.comm.rBPFValues.html#sint32_to_vint">sint32_to_vint</a></span> <span class="id">ofs</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inl">inl</a></span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">mrs_num</span> <span class="id">mrs</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ptr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.comm.rBPFValues.html#cmp_ptr32_null">cmp_ptr32_null</a></span> <span class="id">m</span> <span class="id">ptr</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">is_null</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">m</span>, <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#store_mem">store_mem</a></span> <span class="id">ptr</span> <span class="id">chunk</span> (<span class="id">rs</span>#<span class="id">r</span>) <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">m</span>', <span class="id"><a href="bpf.comm.Flag.html#BPF_OK">BPF_OK</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">i</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#check_mem">check_mem</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memtype.html#Writable">Writable</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">mrs_num</span> <span class="id">mrs</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ptr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.comm.rBPFValues.html#cmp_ptr32_null">cmp_ptr32_null</a></span> <span class="id">m</span> <span class="id">ptr</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">is_null</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">is_null</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">m</span>, <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_MEM">BPF_ILLEGAL_MEM</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#store_mem">store_mem</a></span> <span class="id">ptr</span> <span class="id">chunk</span> (<span class="id"><a href="bpf.comm.rBPFValues.html#sint32_to_vint">sint32_to_vint</a></span> <span class="id">i</span>) <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">m</span>', <span class="id"><a href="bpf.comm.Flag.html#BPF_OK">BPF_OK</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="eval_ins">eval_ins</a></span> (<span class="id">rs</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#regset">regset</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#int64">int64</a></span>) (<span class="id">len</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#int64">int64</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">rs</span>#<span class="id"><a href="bpf.rbpf32.TSSyntax.html#BPC">BPC</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">pc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.cmpu">Int.cmpu</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Clt">Clt</a></span> <span class="id">pc</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">len</span>))) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">List.nth_error</a></span> <span class="id">l</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">pc</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id"><a name="check_mem_prop">check_mem_prop</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">ck</span> <span class="id">addr</span> <span class="id">n</span> <span class="id">mrs</span> <span class="id">m</span> <span class="id">ptr</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#check_mem">check_mem</a></span> <span class="id">p</span> <span class="id">ck</span> <span class="id">addr</span> <span class="id">n</span> <span class="id">mrs</span> <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ptr</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">exists</span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id">ptr</span> = <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id">m</span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id">m</span> <span class="id">b</span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span> - 1) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)%<span class="id">bool</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span> <span class="id">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id">ptr</span> = <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vnullptr">Vnullptr</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id"><a name="_bpf_get_call">_bpf_get_call</a></span> : <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#ident">ident</a></span> -&gt; <span class="id"><a href="https://compcert.org/doc/html/compcert.common.AST.html#signature">signature</a></span> -&gt; <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span> * <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="step">step</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#int64">int64</a></span>) (<span class="id">kv</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">len</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">rs</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#regset">regset</a></span>) (<span class="id">mrs_num</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">mrs</span>: <span class="id"><a href="bpf.comm.MemRegion.html#MyMemRegionsType">MyMemRegionsType</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="bpf.rbpf32.TSSyntax.html#regset">regset</a></span> * <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span> * <span class="id"><a href="bpf.comm.Flag.html#bpf_flag">bpf_flag</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#eval_ins">eval_ins</a></span> <span class="id">rs</span> <span class="id">l</span> <span class="id">len</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ins64</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.TSDecode.html#decode_ind">decode_ind</a></span> <span class="id">ins64</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ins</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ins</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="bpf.rbpf32.TSSyntax.html#Pload">Pload</a></span> <span class="id">chunk</span> <span class="id">d</span> <span class="id">s</span> <span class="id">ofs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#step_load_x_operation">step_load_x_operation</a></span> (<span class="id"><a href="bpf.rbpf32.TSSyntax.html#sizeOp2chunk">sizeOp2chunk</a></span> <span class="id">chunk</span>) <span class="id">d</span> <span class="id">s</span> <span class="id">ofs</span> <span class="id">rs</span> <span class="id">mrs_num</span> <span class="id">mrs</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>', <span class="id">f</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="bpf.rbpf32.TSSyntax.html#nextinstr">nextinstr</a></span> <span class="id">rs</span>', <span class="id">m</span>, <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="bpf.rbpf32.TSSyntax.html#Pstore">Pstore</a></span> <span class="id">chunk</span> <span class="id">d</span> <span class="id">s</span> <span class="id">ofs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#step_store_operation">step_store_operation</a></span> (<span class="id"><a href="bpf.rbpf32.TSSyntax.html#sizeOp2chunk">sizeOp2chunk</a></span> <span class="id">chunk</span>) <span class="id">d</span> <span class="id">s</span> <span class="id">ofs</span> <span class="id">rs</span> <span class="id">mrs_num</span> <span class="id">mrs</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">m</span>, <span class="id">f</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="bpf.rbpf32.TSSyntax.html#nextinstr">nextinstr</a></span> <span class="id">rs</span>, <span class="id">m</span>, <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="bpf.rbpf32.TSSyntax.html#Palu32">Palu32</a></span> <span class="id">bop</span> <span class="id">d</span> <span class="id">s</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BState.html#jit_call_simplb">jit_call_simplb</a></span> <span class="id">kv</span> <span class="id">rs</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>', <span class="id">m</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ( <span class="id">rs</span>', <span class="id">m</span>', <span class="id"><a href="bpf.comm.Flag.html#BPF_OK">BPF_OK</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="bpf.rbpf32.TSSyntax.html#Pjmp">Pjmp</a></span> <span class="id">ofs</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>#<span class="id"><a href="bpf.rbpf32.TSSyntax.html#BPC">BPC</a></span> &lt;- (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> <span class="id">rs</span>#<span class="id"><a href="bpf.rbpf32.TSSyntax.html#BPC">BPC</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">ofs</span>)) <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vone">Vone</a></span>), <span class="id">m</span>, <span class="id"><a href="bpf.comm.Flag.html#BPF_OK">BPF_OK</a></span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="bpf.rbpf32.TSSyntax.html#Pjmpcmp">Pjmpcmp</a></span> <span class="id">op</span> <span class="id">d</span> <span class="id">s</span> <span class="id">ofs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.TSSyntax.html#eval_cmp">eval_cmp</a></span> <span class="id">op</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">d</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>#<span class="id"><a href="bpf.rbpf32.TSSyntax.html#BPC">BPC</a></span> &lt;- (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Val.add">Val.add</a></span> <span class="id">rs</span>#<span class="id"><a href="bpf.rbpf32.TSSyntax.html#BPC">BPC</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">ofs</span>)) <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vone">Vone</a></span>), <span class="id">m</span>, <span class="id"><a href="bpf.comm.Flag.html#BPF_OK">BPF_OK</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="bpf.rbpf32.TSSyntax.html#nextinstr">nextinstr</a></span> <span class="id">rs</span>, <span class="id">m</span>, <span class="id"><a href="bpf.comm.Flag.html#BPF_OK">BPF_OK</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="bpf.rbpf32.TSSyntax.html#Pcall">Pcall</a></span> <span class="id">id</span> <span class="id">sg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#_bpf_get_call">_bpf_get_call</a></span> <span class="id">id</span> <span class="id">sg</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">v</span>, <span class="id">m1</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="bpf.rbpf32.TSSyntax.html#nextinstr">nextinstr</a></span> (<span class="id">rs</span> # <span class="id"><a href="bpf.rbpf32.TSSyntax.html#R0">R0</a></span> &lt;- (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vint">Vint</a></span> <span class="id">v</span>)), <span class="id">m1</span>, <span class="id"><a href="bpf.comm.Flag.html#BPF_OK">BPF_OK</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="bpf.rbpf32.TSSyntax.html#Pret">Pret</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>, <span class="id">m</span>, <span class="id"><a href="bpf.comm.Flag.html#BPF_SUCC_RETURN">BPF_SUCC_RETURN</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="bpf_interpreter_aux">bpf_interpreter_aux</a></span> (<span class="id">fuel</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#int64">int64</a></span>) (<span class="id">len</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">kv</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">jit_ins</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#int">int</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">rs</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#regset">regset</a></span>) (<span class="id">mrs_num</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">mrs</span>: <span class="id"><a href="bpf.comm.MemRegion.html#MyMemRegionsType">MyMemRegionsType</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>) {<span class="kwd">struct</span> <span class="id">fuel</span>}: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="bpf.rbpf32.TSSyntax.html#regset">regset</a></span> * <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span> * <span class="id"><a href="bpf.comm.Flag.html#bpf_flag">bpf_flag</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">fuel</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>, <span class="id">m</span>, <span class="id"><a href="bpf.comm.Flag.html#BPF_ILLEGAL_LEN">BPF_ILLEGAL_LEN</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">fuel0</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#step">step</a></span> <span class="id">l</span> <span class="id">kv</span> <span class="id">len</span> <span class="id">rs</span> <span class="id">mrs_num</span> <span class="id">mrs</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>', <span class="id">m</span>' ,<span class="id">f</span>') =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.Flag.html#flag_eq">flag_eq</a></span> <span class="id">f</span>' <span class="id"><a href="bpf.comm.Flag.html#BPF_OK">BPF_OK</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpf_interpreter_aux</span> <span class="id">fuel0</span> <span class="id">l</span> <span class="id">len</span> <span class="id">kv</span> <span class="id">jit_ins</span> <span class="id">rs</span>' <span class="id">mrs_num</span> <span class="id">mrs</span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>', <span class="id">m</span>', <span class="id">f</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="bpf_interpreter">bpf_interpreter</a></span> (<span class="id">fuel</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ctx_ptr</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#int64">int64</a></span>) (<span class="id">len</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id">tp_kv</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">tp_bin</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="https://compcert.org/doc/html/compcert.lib.Integers.html#int">int</a></span>) (<span class="id">rs</span>: <span class="id"><a href="bpf.rbpf32.TSSyntax.html#regset">regset</a></span>) (<span class="id">mrs_num</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">mrs</span>: <span class="id"><a href="bpf.comm.MemRegion.html#MyMemRegionsType">MyMemRegionsType</a></span>) (<span class="id">m</span>: <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#val">val</a></span> * <span class="id"><a href="bpf.rbpf32.TSSyntax.html#regset">regset</a></span> * <span class="id"><a href="https://compcert.org/doc/html/compcert.common.Memory.html#mem">mem</a></span> * <span class="id"><a href="bpf.comm.Flag.html#bpf_flag">bpf_flag</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs1</span> := <span class="id">rs</span>#<span class="id"><a href="bpf.rbpf32.TSSyntax.html#R1">R1</a></span> &lt;- <span class="id">ctx_ptr</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="bpf.rbpf32.BSemanticsSimpl.html#bpf_interpreter_aux">bpf_interpreter_aux</a></span> <span class="id">fuel</span> <span class="id">l</span> <span class="id">len</span> <span class="id">tp_kv</span> <span class="id">tp_bin</span> <span class="id">rs1</span> <span class="id">mrs_num</span> <span class="id">mrs</span> <span class="id">m</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>', <span class="id">m</span>' ,<span class="id">f</span>') =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="bpf.comm.Flag.html#flag_eq">flag_eq</a></span> <span class="id">f</span>' <span class="id"><a href="bpf.comm.Flag.html#BPF_SUCC_RETURN">BPF_SUCC_RETURN</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">rs</span>'#<span class="id"><a href="bpf.rbpf32.TSSyntax.html#R0">R0</a></span>, <span class="id">rs</span>', <span class="id">m</span>', <span class="id">f</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://compcert.org/doc/html/compcert.common.Values.html#Vzero">Vzero</a></span>, <span class="id">rs</span>', <span class="id">m</span>', <span class="id">f</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.
</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
